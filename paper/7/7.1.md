---
marp: true
---
<!--
headingDivider: 1
-->

# 7.1 尤度とベイズ統計

この章ではMCMC法の統計学への応用例を紹介します。

# 7.1.1 「もっともらしさ」を定義する

MCMC法をベイズ統計に応用するとき、何を変数と思い、何をパラメーターと思うかで混乱しがち

まずは基礎を固める

例としてコイン投げを考える

通常、コイン投げをしたら「表と裏が同じ確率で現れる」とするのが「もっともらしい」仮定です。

しかし、実際に投げると10回投げたら９回表が出たとする


１０回のコイン投げでは合計

$$
2^{10} = 1024通り
$$

の結果があり裏が１回だけというのはこのうち１０通りだけなので裏と表の出る確率が半々だとしたら確率は１％ほどしかない

---

このコインを投げた時に表が出る確率pはどのくらいと推定できるでしょうか？

直観的にはp=9/10だと思うかもしれない

確かにこれは「もっともらしい」が、この直感は定量的にどの程度正しい？

このような疑問に答えるための論理的枠組みを構築する

表が出る確率をpとしているので、10回中9回が表になる確率は

$$
10p^9(1-p)
$$

です。

これをｐの関数としてプロットすると下の図7.1のようになる。

---

![](../image/図7.1.png)

p=9/10で最大値(約0.39)を取ります

「表が出る確率は0.9」と結論するのはそれなりにもっともらしそう

一方、p=1/2だったとすると、この現象が実現する確率は約0.01なので、あまりもっともらしくない

ですが、実際にp=0.9と結論できるかというとそうでもない

p=0.8からp=0.95あたりであれば $10p^9(1-p)$ の値は十分に大きく、それなりのもっともらしさがある。

---

そこで、ここで計算した「仮に表が出る確率がpだったとしたとき、実際に「表が9回出る」という現象が起こる確率 $10p^9(1-p)$ 」を「もっともらしさ」を定量的に特徴づける指標として採用し、尤度（likelihood）と呼びます。

もっと一般的に、１０回中ｋ回が表になる確率は

$$
P(k|p) = \binom{10}{k} \cdot p^k (1 - p)^{10 - k} = \frac{10!}{k!(10 - k)!} \cdot p^k (1 - p)^{10 - k} \tag{7.2}
$$

です

表の出る確率がpであると仮定したことを強調するためにP(k|p)という記号を用いました。

このP(k|p)が、「１０回中回が表だった」という結果がすでにある時の尤度です。

尤度が最も大きくなるようなpの値が一番もっともらしいだろうと考えるのが最尤法です。

---

このように、尤度というのは、実際にある現象が起きた時に、その現象が起こる確率として定義されます。

普通の確率と違うのは、現象を特徴づけている量（今の場合なら「表が出る確率」p）を変数とみなす点です

「確率」と「尤度」は同じ関数ですが、その解釈が異なります

- 表の出る確率pが与えられていると思うと、P(k|p)は１０回中ｋ回表が出る「確率」
- 10回中k回が表だったという結果がすでに与えられており、そこから表の出る確率ｐを逆算したいと思うと、P(k|p)は表の出る確率がｐであるという推測のもっともらしさを表す「尤度」

---

同じ考え方は確率分布にも適用できます

例としてガウス分布

を考える。

# 7.1.2 尤度の計算　~ガウス分布を例に

それでは、ガウス分布の場合について、マルコフ連鎖モンテカルロ法を使って尤度を計算してみる

# 一変数の場合

# 多変数の場合

# 7.1.4 ベイズの定理

# 7.1.5 MCMC法によるベイズ更新の例


$$
P(p|k) = \frac{P(k|p) \cdot P(p)}{P(k)} \tag{7.23}
$$

や

# 