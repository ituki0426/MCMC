---
marp: true
---
<!--
headingDivider: 1
-->

# 6.よく使うアルゴリズム

4章と5章ではメトロポリス法を解説した。

この章ではメトロポリス法以外のアルゴリズムをいくつか紹介する。

一見すると難しいことをしているが、要は

**自己相関を減らして効率よく配位を生成するにはどうしたらよいか**

という問題を様々な手法を、駆使して解決しているだけ。

その一つの方法が、メトロポリス・ヘイスティング法であり更新の提案確率 
$$
f({x}→{x'})
$$
をうまく選び、受理確率を１に近づけることができる。

ギブスサンプリングやHMC法は更新の提案確率を非常にうまく選んだメトロポリス・ヘイスティング法である。

# 6.0 ハミルトン方程式

ハミルトン方程式について、HMC法を理解するために必要な範囲に絞って説明する。

物理の知識がある人にとってわかりやすくなるように、Ｓの代わりにＶという記号を使う。

ハミルトニアンは

$$
ハミルトニアン = 力学エネルギー + 位置エネルギー
$$

なので、

$$
H = \frac{1}{2} \sum_{i=1}^{k} p_i^2 + V(x_1, \cdots, x_k) \tag{C.1}
$$

k個の粒子が存在し、 $x_i$ がi番目の粒子の座標で、$p_i$ がi番目の粒子の運動量である。

ただし、粒子の質量は１とする。

すると、ハミルトニアンをエネルギーと同一視できる。

